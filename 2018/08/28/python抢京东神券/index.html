<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> python抢京东神券 · Hexo</title><meta name="description" content="python抢京东神券 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/PecoKael" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">python抢京东神券</h1><div class="post-info">Aug 28, 2018</div><div class="post-content"><p>某东天天做活动，今天纸品清洁超级品类日，14点抢一个199-198瞬间没了。我就想是不是可以用脚本来抢，于是记录下过程。</p>
<a id="more"></a>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><blockquote>
<ul>
<li>python</li>
<li>chrome浏览器</li>
<li>chromedriver</li>
<li>selenium</li>
</ul>
</blockquote>
<p>python + pip 环境安装请参考：<br><a href="http://www.cnblogs.com/duoyi/articles/7904634.html" target="_blank" rel="noopener">http://www.cnblogs.com/duoyi/articles/7904634.html</a></p>
<h2 id="安装selenium"><a href="#安装selenium" class="headerlink" title="安装selenium"></a>安装selenium</h2><p>selenium是一个功能自动化工具，官网：<a href="https://www.seleniumhq.org（需要梯子）" target="_blank" rel="noopener">https://www.seleniumhq.org（需要梯子）</a><br>我们可以用pip来安装selenium<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install selenium</span><br></pre></td></tr></table></figure></p>
<h2 id="下载chromedriver"><a href="#下载chromedriver" class="headerlink" title="下载chromedriver"></a>下载chromedriver</h2><p>使用webDriver再chrome上测试时，需要下载chrome驱动，从<a href="http://chromedriver.storage.googleapis.com/index.html下载" target="_blank" rel="noopener">http://chromedriver.storage.googleapis.com/index.html下载</a><br>下载完成后注意要把chromedriver放到python文件夹（如 C:\Users\Administrator\AppData\Local\Programs\Python\Python36）和chrome文件夹（如 C:\Program Files\Google\Chrome\Application）下面</p>
<h2 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JDQUAN</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,url)</span>:</span></span><br><span class="line">        self.driver=webdriver.Chrome()</span><br><span class="line">        self.driver.get(url)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login_jd</span><span class="params">(self,num,pwd)</span>:</span></span><br><span class="line">        self.driver.find_element_by_link_text(<span class="string">'账户登录'</span>).click()</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">'loginname'</span>).send_keys(num)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">'nloginpwd'</span>).send_keys(pwd)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">'loginsubmit'</span>).click()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">buy_on_time</span><span class="params">(self,buytime,quan_link)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            now = datetime.datetime.now().strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">            <span class="keyword">if</span> now == buytime:</span><br><span class="line">              <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">                self.driver.get(quan_link)</span><br><span class="line">                time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(self,buytime,quan_link)</span>:</span></span><br><span class="line">        num=<span class="string">'num'</span></span><br><span class="line">        pwd=<span class="string">'pwd'</span></span><br><span class="line">        self.login_jd(num,pwd)</span><br><span class="line">        self.buy_on_time(buytime,quan_link)</span><br><span class="line">jd=JDQUAN(<span class="string">'https://passport.jd.com/new/login.aspx'</span>)</span><br><span class="line">jd.start(<span class="string">'2018-08-28 20:00:00'</span>,<span class="string">'https://coupon.jd.com/ilink/couponSendFront/send_index.action?key=a53659ef12e44caaa8fca46ff86a0bbe&amp;roleId=13710707&amp;to=sale.jd.com/act/s6qSug4WUfYZKkzl.html&amp;cpdad=1DLSUE'</span>)</span><br></pre></td></tr></table></figure>
<p>num和pwd为账号和比吗，实例化JDQUAN穿入的url是登录页，start函数的两个参数是开始的时间和优惠券的地址。<br>优惠券的地址可以按f12再浏览器里找到。<br><img src="/img/coupon.png"><br>如果登录的时候遇到需要输入验证码的情况，可以手动输入，再手动点击登录。只要在抢券时间前登录就可以。<br>最后直接运行就可以了，运气好的话就能抢到了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python main.py</span><br></pre></td></tr></table></figure></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/09/01/2018年8月读书记录/" class="prev">PREV</a><a href="/2018/08/02/2018年7月读书笔记/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>